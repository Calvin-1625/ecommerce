{% load static %}
<!doctype html>

<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title> Home Template </title>

    {% include 'base/css.html' %}
    {% block base_head %} {% endblock %}
  </head>
  <body>
    <div class="container">
    {% include 'base/navbar.html' with brand_name='eCommerce'%}
    {% block content %}{% endblock %}

    
    {% include 'base/js.html' %}
    <script type="text/javascript">
      $(document).ready(function(){
        var productForm = $(".form-product-ajax")

        productForm.submit(function(event){
          event.preventDefault();
          console.log("Form is not sending")
          var thisForm = $(this)
          var actionEndPoint = thisForm.attr("action");
          var httpMethod = thisForm.attr("method");
          var formData = thisForm.serialize();

          $.ajax({
            url:actionEndPoint,
            method:httpMethod,
            data:formData,
            success: function(data){
              var submitSpan = thisForm.find(".submit-span")
              if (data.added){
                submitSpan.html("In cart <button type='submit' class='btn btn-link'>Remove?</button>")
              } else {
                submitSpan.html("<button class='btn btn-link'>Add to cart</button>")
              }
            },
            error: function(errorData){
              console.log("error")
              console.log(errorData)
            }
            
          })

        })
      })

    </script>
    </div>
  </body>
</html>